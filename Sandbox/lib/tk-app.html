<!--
Copyright 2013 The Toolkitchen Authors. All rights reserved.
Use of this source code is governed by a BSD-style
license that can be found in the LICENSE file.
-->
<element name="tk-app" on-keyup="keyup" on-design-changed="designChanged">
  <link rel="stylesheet" href="css/tk-app.css">
  <template>
    <g-toolbar>
      <g-selector selected="{{selectedMode}}">
        <g-icon-button name="designer" src="assets/design.png"></g-icon-button>
        <g-icon-button name="source" src="assets/code.png"></g-icon-button>
      </g-selector>
    </g-toolbar>
    <div id="main">
      <tk-designer id="designer" selected="{{selected}}" element="{{element}}"></tk-designer>
      <tk-source id="source" fontSize="18px" element="{{element}}"></tk-source> 
      <tk-tools id="tools" selected="{{selected}}" element="{{element}}"
          on-parent-element="selectParentElement"
          on-delete-element="deleteElement"
          on-property-changed="designChanged"
      ></tk-tools>
    </div>
  </template>
  <script>
    Toolkit.register(this, {
      element: null,
      selected: null,
      selectedMode: '',
      designMode: true,
      ready: function() {
        this.selectedMode = 'designer';
      },
      designModeChanged: function () {
        this.selectedMode = this.designMode ? 'designer' : 'source';
      },
      selectedModeChanged: function (oldTabName) {
        this.classFollows(this.$[this.selectedMode], this.$[oldTabName],
          'tab-selected');
      },
      designChanged: function() {
        this.$.source.update();
        this.$.tools.update();
        this.$.designer.update();
      },
      selectParentElement: function() {
        this.$.designer.selectParentElement();
      },
      deleteElement: function() {
        this.$.designer.deleteElement();
      }
    });
  </script>
</element>
